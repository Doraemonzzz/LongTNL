
Total GPUS: 8
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:01<00:00, 30.37it/s]
Resolving data files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:00<00:00, 188932.61it/s]
Dataset Size: 1370296
  0%|                                                                                                                                                                                                           | 0/100 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/yhzhang/LongMamba/train.py", line 181, in <module>
    main(args.parse_args())
  File "/home/yhzhang/LongMamba/train.py", line 117, in main
    logits = model(batch["input_ids"][..., :-1], delta_ratio=args.delta_ratio).logits
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/accelerate/utils/operations.py", line 680, in forward
    return model_forward(*args, **kwargs)
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/accelerate/utils/operations.py", line 668, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/home/yhzhang/miniconda3/envs/mamba/lib/python3.10/site-packages/torch/amp/autocast_mode.py", line 16, in decorate_autocast
    return func(*args, **kwargs)
TypeError: MambaLMHeadModel.forward() got an unexpected keyword argument 'delta_ratio'
Max train steps: 100
Total batch size: 64